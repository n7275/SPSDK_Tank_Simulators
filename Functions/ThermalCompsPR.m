function ThermalCompsPR(dt)  global mass;  global MAX_SUB;  global SPECIFICC_GAS;  global SPECIFICC_LIQ;  global MMASS;  global L_DENSITY;  global BULK_MOD;  global VAPPRESS;  global VAPGRAD;  global R_CONST;  global total_mass;  global vapor_mass;  global Q;  global Temp;  global Volume;  global Press;  global ANTIONE_A;  global ANTIONE_B;  global PR_Ar;  global PR_Br;  ##1. compute average temp  AvgC = 0;	  for ii = 1:MAX_SUB    AvgC += ((vapor_mass(ii) * SPECIFICC_GAS(ii)) + ((mass(ii) - vapor_mass(ii)) * SPECIFICC_GAS(ii)));  endfor  if GetMass() > 0;    AvgC = AvgC / total_mass;    Temp = Q / AvgC / total_mass;  else    Temp = 0;  endif
  [A, B] = GetPRCoeff()  [x1, x2, x3] = SolveCubic((1-B),(A-3*B^2-2*B),(-A*B+B^2+B^3));    (x1*R_CONST*Temp)/GetVapPress(1)      endfunction